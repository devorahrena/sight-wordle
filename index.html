<!DOCTYPE html>
<html lang="en">

<head>
  <title>Sight Wordle</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="stylesheet.css">
  <script type="text/javascript" src="confetti.js"></script>
</head>

<body onload="initialize()">
  <div id="game">
    <p id="answer" hidden>
    <div id="board">
  </div>

  <script>
    function initialize() {
      const words = ["and", "fix", "own", "are", "fly", "odd", "ape", "fry", "our", "for", "pet", "act", "got", "pat", "ask", "get", "peg", "arm", "paw", "pup", "ago", "gas", "pit", "air", "hat", "put", "ate", "hit", "pot", "all", "has", "pop", "but", "had", "pin", "bye", "how", "rat", "bad", "her", "rag", "big", "his", "rub", "bed", "hen", "row", "bat", "ink", "rug", "boy", "ice", "run", "bus", "ill", "rap", "bag", "ram", "box", "jug", "see", "bee", "jam", "saw", "buy", "jar", "set", "bun", "job", "sit", "cub", "jog", "sir", "cat", "kit", "sat", "car", "key", "sob", "cut", "tap", "cow", "lit", "tip", "cry", "let", "top", "cab", "lay", "tug", "can", "mat", "tow", "dad", "man", "toe", "mad", "tan", "mug", "ten", "did", "mix", "two", "dug", "map", "use", "den", "mum", "van", "dot", "mud", "vet", "dip", "mom", "was", "day", "may", "wet", "ear", "met", "win", "eye", "net", "won", "eat", "new", "wig", "end", "nap", "war", "elf", "now", "why", "egg", "nod", "who", "far", "net", "way", "fat", "not", "wow", "few", "nut", "you", "fan", "oat", "yes", "fun", "one", "yak", "fit", "out", "yet", "fin", "owl", "zip", "fox", "old", "zap"]
      var answer = words[Math.floor(Math.random() * words.length)];
      document.getElementById("answer").innerHTML = answer;
      addNewRow(0);
      document.getElementById("0a").focus();
    }

    function moveCursor(id) {
      var counter = id.substr(0, id.length - 1);
      var index = id[id.length - 1];
      var key = event.keyCode || event.charCode;
      event.preventDefault();
      if (key == 8 || key == 46) {
        if (document.getElementById(id).value.length == 0) {
          if (index == "b") {
            document.getElementById(counter + "a").focus();
          } else if (index == "c") {
            document.getElementById(counter + "b").focus();
          }
        } else {
          document.getElementById(id).value = "";
        }
      } else if (key == 13) {
        checkGuess(id);
      } else if (index === "a") {
        document.getElementById(counter + "a").value = String.fromCharCode(key).toLowerCase();
        document.getElementById(counter + "b").focus();
      } else if (index == "b") {
        document.getElementById(counter + "b").value = String.fromCharCode(key).toLowerCase();
        document.getElementById(counter + "c").focus();
      } else {
        document.getElementById(counter + "c").value = String.fromCharCode(key).toLowerCase();
      }
      //document.getElementById(id).nextSibling.focus();
    }

    function checkLetter(counter, index) {
      var letter = document.getElementById(counter + index);
      var answer = document.getElementById("answer").innerText;
      var green = (index == "a" ? answer[0] : (index == "b" ? answer[1] : answer[2]));
      var yellow = (index == "a" ? answer[1] + answer[2] : (index == "b" ? answer[0] + answer[2] : answer[0] + answer[1]));
      var val = letter.value;
      letter.defaultValue = val;
      letter.disabled = true;
      if (val == green) {
        letter.style.backgroundColor = "green";
        return 1;
      } else if (val == yellow[0] || val == yellow[1]) {
        letter.style.backgroundColor = "yellow";
      } else {
        letter.style.backgroundColor = "white";
      }
      return 0;
    }

    function checkGuess(id) {
      var counter = id.substr(0, id.length - 1);
      var a = checkLetter(counter, "a");
      var b = checkLetter(counter, "b");
      var c = checkLetter(counter, "c");
      if (a + b + c == 3) {
        confetti();
        //winning condition
      } else {
        counter++;
        addNewRow(counter);
        document.getElementById(counter + "a").focus();
      }
    }

    function addNewRow(counter) {
      var board = document.getElementById("board");
      board.innerHTML += '<div class="row"><input id="' + counter + 'a" type="text" maxlength="1" onkeydown="moveCursor(this.id)"></input><input id="' + counter + 'b" type="text" maxlength="1" onkeydown="moveCursor(this.id)"></input><input id="' + counter + 'c" type="text" maxlength="1" onkeydown="moveCursor(this.id)"></input></div>'
    }
    
  </script>
</body>

</html>
